image: gradle:jdk12

pipelines:
  branches:
    dev:
      - step:
          name: deploy:snapshot
          script:
            - bash ./gradlew --build-cache assemble
            - bash ./gradlew checkstyleMain
            - bash ./gradlew publish
    feature/*:
      - step:
          name: deploy:feature
          script:
            - bash ./gradlew --build-cache assemble
            - bash ./gradlew checkstyleMain
            - bash ./gradlew publish
    bugfix/*:
      - step:
          name: deploy:bugfix
          script:
            - bash ./gradlew --build-cache assemble
            - bash ./gradlew checkstyleMain
            - bash ./gradlew publish
    master:
      - step:
          name: sonar:snapshot
          script:
            - bash ./gradlew --build-cache assemble
            - bash ./gradlew checkstyleMain
            - bash ./gradlew publish
            - bash ./gradlew sonarqube -Dsonar.projectKey=LegendServiceRegistry -Dsonar.host.url=https://sonar.playlegend.dev -Dsonar.login=$SONAR_LOGIN -Dsonar.projectVersion=master